"undefined"!=typeof THREE&&(console.log("Creating THREE.Geometry polyfill for ThreeBSP compatibility"),THREE.Face3=function(e,t,o,s,r,n){this.a=e,this.b=t,this.c=o,this.normal=s instanceof THREE.Vector3?s:new THREE.Vector3,this.vertexNormals=Array.isArray(s)?s:[],this.color=r instanceof THREE.Color?r:new THREE.Color,this.vertexColors=[],this.materialIndex=void 0!==n?n:0},THREE.Face4=function(e,t,o,s,r,n,i){this.a=e,this.b=t,this.c=o,this.d=s,this.normal=r instanceof THREE.Vector3?r:new THREE.Vector3,this.vertexNormals=Array.isArray(r)?r:[],this.color=n instanceof THREE.Color?n:new THREE.Color,this.vertexColors=[],this.materialIndex=void 0!==i?i:0},THREE.Geometry=function(){this.uuid=THREE.MathUtils.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1},THREE.Geometry.prototype={constructor:THREE.Geometry,computeFaceNormals:function(){for(let e=0;e<this.faces.length;e++){const t=this.faces[e];if(t instanceof THREE.Face3){const e=this.vertices[t.a],o=this.vertices[t.b],s=this.vertices[t.c],r=(new THREE.Vector3).subVectors(s,o),n=(new THREE.Vector3).subVectors(e,o);r.cross(n),r.normalize(),t.normal.copy(r)}else if(t instanceof THREE.Face4){const e=this.vertices[t.a],o=this.vertices[t.b],s=this.vertices[t.c],r=this.vertices[t.d],n=(new THREE.Vector3).subVectors(s,o),i=(new THREE.Vector3).subVectors(e,o);n.cross(i),n.normalize();const c=(new THREE.Vector3).subVectors(r,s),a=(new THREE.Vector3).subVectors(e,s);c.cross(a),c.normalize();const l=(new THREE.Vector3).add(n).add(c).divideScalar(2).normalize();t.normal.copy(l)}}},computeVertexNormals:function(){for(let e=0;e<this.faces.length;e++){const t=this.faces[e];t.vertexNormals?t.vertexNormals.length=0:t.vertexNormals=[]}const e=new Array(this.vertices.length);for(let t=0;t<this.vertices.length;t++)e[t]=new THREE.Vector3;for(let t=0;t<this.faces.length;t++){const o=this.faces[t];o instanceof THREE.Face3?(e[o.a].add(o.normal),e[o.b].add(o.normal),e[o.c].add(o.normal)):o instanceof THREE.Face4&&(e[o.a].add(o.normal),e[o.b].add(o.normal),e[o.c].add(o.normal),e[o.d].add(o.normal))}for(let t=0;t<this.faces.length;t++){const o=this.faces[t];o instanceof THREE.Face3?(o.vertexNormals[0]=e[o.a].clone().normalize(),o.vertexNormals[1]=e[o.b].clone().normalize(),o.vertexNormals[2]=e[o.c].clone().normalize()):o instanceof THREE.Face4&&(o.vertexNormals[0]=e[o.a].clone().normalize(),o.vertexNormals[1]=e[o.b].clone().normalize(),o.vertexNormals[2]=e[o.c].clone().normalize(),o.vertexNormals[3]=e[o.d].clone().normalize())}},computeBoundingBox:function(){if(0===this.vertices.length)return void(this.boundingBox=new THREE.Box3(new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,0)));const e=this.vertices[0];let t=e.x,o=e.y,s=e.z,r=t,n=o,i=s;for(let e=1;e<this.vertices.length;e++){const c=this.vertices[e];t=Math.min(t,c.x),o=Math.min(o,c.y),s=Math.min(s,c.z),r=Math.max(r,c.x),n=Math.max(n,c.y),i=Math.max(i,c.z)}this.boundingBox=new THREE.Box3(new THREE.Vector3(t,o,s),new THREE.Vector3(r,n,i))},computeBoundingSphere:function(){if(this.computeBoundingBox(),!this.boundingBox)return;const e=new THREE.Vector3;this.boundingBox.getCenter(e);let t=0;for(let o=0;o<this.vertices.length;o++){const s=e.distanceToSquared(this.vertices[o]);s>t&&(t=s)}this.boundingSphere=new THREE.Sphere(e,Math.sqrt(t))},merge:function(e,t,o){if(!e)return this;const s=e.vertices,r=e.faces,n=this.vertices.length;for(let e=0;e<s.length;e++){let o=s[e].clone();t&&o.applyMatrix4(t),this.vertices.push(o)}for(let e=0;e<r.length;e++){const t=r[e];if(t instanceof THREE.Face3){const e=new THREE.Face3(t.a+n,t.b+n,t.c+n,t.normal.clone(),t.color.clone(),t.materialIndex+(o||0));e.vertexNormals=t.vertexNormals?t.vertexNormals.map(e=>e.clone()):[],this.faces.push(e)}}return this}},console.log("THREE.Geometry polyfill created successfully"));