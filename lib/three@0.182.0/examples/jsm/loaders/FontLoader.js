import{FileLoader,Loader,ShapePath}from"three";class FontLoader extends Loader{constructor(e){super(e)}load(e,t,r,s){const a=this,o=new FileLoader(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(e){const r=a.parse(JSON.parse(e));t&&t(r)},r,s)}parse(e){return new Font(e)}}class Font{constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e,t=100,r="ltr"){const s=[],a=createPaths(e,t,this.data,r);for(let e=0,t=a.length;e<t;e++)s.push(...a[e].toShapes());return s}}function createPaths(e,t,r,s){const a=Array.from(e),o=t/r.resolution,n=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*o,i=[];let h=0,c=0;"rtl"!=s&&"tb"!=s||a.reverse();for(let e=0;e<a.length;e++){const t=a[e];if("\n"===t)h=0,c-=n;else{const e=createPath(t,o,h,c,r);"tb"==s?(h=0,c+=r.ascender*o):h+=e.offsetX,i.push(e.path)}}return i}function createPath(e,t,r,s,a){const o=a.glyphs[e]||a.glyphs["?"];if(!o)return void console.error('THREE.Font: character "'+e+'" does not exists in font family '+a.familyName+".");const n=new ShapePath;let i,h,c,l,d,u,p,f;if(o.o){const e=o._cachedOutline||(o._cachedOutline=o.o.split(" "));for(let a=0,o=e.length;a<o;){switch(e[a++]){case"m":i=e[a++]*t+r,h=e[a++]*t+s,n.moveTo(i,h);break;case"l":i=e[a++]*t+r,h=e[a++]*t+s,n.lineTo(i,h);break;case"q":c=e[a++]*t+r,l=e[a++]*t+s,d=e[a++]*t+r,u=e[a++]*t+s,n.quadraticCurveTo(d,u,c,l);break;case"b":c=e[a++]*t+r,l=e[a++]*t+s,d=e[a++]*t+r,u=e[a++]*t+s,p=e[a++]*t+r,f=e[a++]*t+s,n.bezierCurveTo(d,u,p,f,c,l)}}}return{offsetX:o.ha*t,path:n}}export{FontLoader,Font};