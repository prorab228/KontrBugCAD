import{Tab}from"../ui/Tab.js";import{List}from"../ui/List.js";import{Item}from"../ui/Item.js";import{createValueSpan}from"../ui/utils.js";import{ValueNumber,ValueSlider,ValueSelect,ValueCheckbox,ValueColor,ValueButton}from"../ui/Values.js";class ParametersGroup{constructor(e,t){this.parameters=e,this.name=t,this.paramList=new Item(t)}close(){return this.paramList.close(),this}add(e,t,...a){const n=typeof e[t];let s=null;return"object"==typeof a[0]?s=this.addSelect(e,t,a[0]):"number"===n?s=a.length>=2?this.addSlider(e,t,...a):this.addNumber(e,t,...a):"boolean"===n?s=this.addBoolean(e,t):"function"===n&&(s=this.addButton(e,t,...a)),s}_addParameter(e,t,a,n){a.name=e=>(n.data[0].textContent=e,a),a.listen=()=>{const n=()=>{const s=a.getValue(),r=e[t];s!==r&&a.setValue(r),requestAnimationFrame(n)};return requestAnimationFrame(n),a}}addFolder(e){const t=new ParametersGroup(this.parameters,e);return this.paramList.add(t.paramList),t}addBoolean(e,t){const a=e[t],n=new ValueCheckbox({value:a});n.addEventListener("change",({value:a})=>{e[t]=a});const s=createValueSpan();s.textContent=t;const r=new Item(s,n.domElement);this.paramList.add(r);const d=r.domElement.firstChild;return d.classList.add("actionable"),d.addEventListener("click",e=>{if(e.target.closest("label"))return;const t=d.querySelector('input[type="checkbox"]');t&&(t.checked=!t.checked,t.dispatchEvent(new Event("change")))}),this._addParameter(e,t,n,r),n}addSelect(e,t,a){const n=e[t],s=new ValueSelect({options:a,value:n});s.addEventListener("change",({value:a})=>{e[t]=a});const r=createValueSpan();r.textContent=t;const d=new Item(r,s.domElement);this.paramList.add(d);return d.domElement.firstChild.classList.add("actionable"),this._addParameter(e,t,s,d),s}addColor(e,t){const a=e[t],n=new ValueColor({value:a});n.addEventListener("change",({value:a})=>{e[t]=a});const s=createValueSpan();s.textContent=t;const r=new Item(s,n.domElement);this.paramList.add(r);return r.domElement.firstChild.classList.add("actionable"),this._addParameter(e,t,n,r),n}addSlider(e,t,a=0,n=1,s=.01){const r=e[t],d=new ValueSlider({value:r,min:a,max:n,step:s});d.addEventListener("change",({value:a})=>{e[t]=a});const i=createValueSpan();i.textContent=t;const o=new Item(i,d.domElement);this.paramList.add(o);return o.domElement.firstChild.classList.add("actionable"),this._addParameter(e,t,d,o),d}addNumber(e,t,...a){const n=e[t],[s,r]=a,d=new ValueNumber({value:n,min:s,max:r});d.addEventListener("change",({value:a})=>{e[t]=a});const i=createValueSpan();i.textContent=t;const o=new Item(i,d.domElement);this.paramList.add(o);return o.domElement.firstChild.classList.add("actionable"),this._addParameter(e,t,d,o),d}addButton(e,t){const a=e[t],n=new ValueButton({text:t,value:a});n.addEventListener("change",({value:a})=>{e[t]=a});const s=new Item(n.domElement);s.itemRow.childNodes[0].style.gridColumn="1 / -1",this.paramList.add(s);return s.domElement.firstChild.classList.add("actionable"),n.name=e=>(n.domElement.childNodes[0].textContent=e,n),n}}class Parameters extends Tab{constructor(e={}){super("Parameters",e);const t=new List("Property","Value");t.domElement.classList.add("parameters"),t.setGridStyle(".5fr 1fr"),t.domElement.style.minWidth="300px";const a=document.createElement("div");a.className="list-scroll-wrapper",a.appendChild(t.domElement),this.content.appendChild(a),this.paramList=t}createGroup(e){const t=new ParametersGroup(this,e);return this.paramList.add(t.paramList),t}}export{Parameters};