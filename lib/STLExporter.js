THREE.STLExporter=class{parse(t,e={}){const o=void 0!==e.binary&&e.binary,r=[];let n,i=0;t.traverse(function(t){if(t.isMesh){const e=t.geometry,o=e.index,n=e.getAttribute("position");i+=null!==o?o.count/3:n.count/3,r.push({object3d:t,geometry:e})}});let s=80;if(!0===o){const t=new ArrayBuffer(2*i+3*i*4*4+80+4);n=new DataView(t),n.setUint32(s,i,!0),s+=4}else n="",n+="solid exported\n";const l=new THREE.Vector3,a=new THREE.Vector3,c=new THREE.Vector3,f=new THREE.Vector3,u=new THREE.Vector3,d=new THREE.Vector3;for(let t=0,e=r.length;t<e;t++){const e=r[t].object3d,o=r[t].geometry,n=o.index,i=o.getAttribute("position");if(null!==n)for(let t=0;t<n.count;t+=3)p(n.getX(t+0),n.getX(t+1),n.getX(t+2),i,e);else for(let t=0;t<i.count;t+=3)p(t+0,t+1,t+2,i,e)}return!1===o&&(n+="endsolid exported\n"),n;function p(t,e,r,i,p){l.fromBufferAttribute(i,t),a.fromBufferAttribute(i,e),c.fromBufferAttribute(i,r),!0===p.isSkinnedMesh&&(p.boneTransform(t,l),p.boneTransform(e,a),p.boneTransform(r,c)),l.applyMatrix4(p.matrixWorld),a.applyMatrix4(p.matrixWorld),c.applyMatrix4(p.matrixWorld),function(t,e,r){f.subVectors(r,e),u.subVectors(t,e),f.cross(u).normalize(),d.copy(f).normalize(),!0===o?(n.setFloat32(s,d.x,!0),s+=4,n.setFloat32(s,d.y,!0),s+=4,n.setFloat32(s,d.z,!0),s+=4):(n+="\tfacet normal "+d.x+" "+d.y+" "+d.z+"\n",n+="\t\touter loop\n")}(l,a,c),x(l),x(a),x(c),!0===o?(n.setUint16(s,0,!0),s+=2):(n+="\t\tendloop\n",n+="\tendfacet\n")}function x(t){!0===o?(n.setFloat32(s,t.x,!0),s+=4,n.setFloat32(s,t.y,!0),s+=4,n.setFloat32(s,t.z,!0),s+=4):n+="\t\t\tvertex "+t.x+" "+t.y+" "+t.z+"\n"}}};