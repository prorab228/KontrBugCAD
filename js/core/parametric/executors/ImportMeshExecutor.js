import*as THREE from"three";import{ParametricExecutor}from"./ParametricExecutor.js";export class ImportMeshExecutor extends ParametricExecutor{execute(e,o){const{filePath:t,color:r=9159498,position:n=[0,0,0],geometryData:i}=e.parameters;let a;if(i){a=new THREE.BufferGeometry;const e=new Float32Array(i.positions);a.setAttribute("position",new THREE.BufferAttribute(e,3)),i.indices&&a.setIndex(new THREE.BufferAttribute(new Uint32Array(i.indices),1)),i.boundingBox&&(a.boundingBox=new THREE.Box3((new THREE.Vector3).fromArray(i.boundingBox.min),(new THREE.Vector3).fromArray(i.boundingBox.max))),a.computeVertexNormals()}else{const e=o.editor.libraryManager.modelCache.get(t);if(!e)throw new Error(`Geometry for ${t} not found in cache`);a=e.geometry.clone()}const u=new THREE.MeshPhongMaterial({color:r}),c=new THREE.Mesh(a,u);c.castShadow=!0,c.receiveShadow=!0,a.computeBoundingBox();const s=a.boundingBox,m=s.max.y-s.min.y,E=(new THREE.Vector3).fromArray(n);return E.y+=m/2,c.position.copy(E),e.outputs.length>0?c.uuid=e.outputs[0]:e.outputs=[c.uuid],c.userData={type:"imported",filePath:t,color:r,originalPosition:n},c}}