import*as THREE from"three";import{TextGeometry}from"three/addons/geometries/TextGeometry.js";import{FontLoader}from"three/addons/loaders/FontLoader.js";import{ParametricExecutor}from"./ParametricExecutor.js";export class Text3DExecutor extends ParametricExecutor{execute(e,t){const{text:o,fontName:r,fontData:a,fontSize:n,depth:s,bevelEnabled:i,bevelThickness:c,bevelSize:l,curveSegments:d,materialType:m,color:u,position:h}=e.parameters;let p;if(a){p=(new FontLoader).parse(a)}else if(p=t.editor.fontManager?.fonts[r],!p)throw new Error(`Text3D: шрифт "${r}" не найден`);const E=new TextGeometry(o,{font:p,size:n,depth:s,curveSegments:d,bevelEnabled:i,bevelThickness:c,bevelSize:l});E.computeBoundingBox();const x=new THREE.Vector3;let b;switch(E.boundingBox.getCenter(x),E.translate(-x.x,-x.y,-x.z/2),m){case"basic":b=new THREE.MeshBasicMaterial({color:u});break;case"phong":b=new THREE.MeshPhongMaterial({color:u,shininess:100});break;default:b=new THREE.MeshStandardMaterial({color:u,roughness:.7,metalness:.2})}const f=new THREE.Mesh(E,b);return f.position.fromArray(h),f.castShadow=!0,f.receiveShadow=!0,f.userData={type:"text3d",text:o,fontName:r,fontSize:n,depth:s,bevelEnabled:i,bevelThickness:c,bevelSize:l,curveSegments:d,materialType:m,color:u},e.outputs.length>0?f.uuid=e.outputs[0]:e.outputs=[f.uuid],f}}