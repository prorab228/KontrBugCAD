class FontManager{constructor(){this.font=null,this.fonts={Arial:null,"Times New Roman":null,Verdana:null},this.init()}async init(){try{this.loadDefaultFont()}catch(t){console.error("Ошибка загрузки шрифтов:",t)}}loadDefaultFont(){this.createBasicFont()}createBasicFont(){this.fonts.Basic={getPath:function(t,e,r,o){const n=[];let c=e;for(let e of t){const t=.6*o,u=this.getCharContour(e,c,r,o);n.push({contours:u,x:c,y:r,width:t,height:o}),c+=t+.1*o}return n}.bind(this),getCharContour:function(t,e,r,o){const n=.6*o,c=o;return{A:this.createAContour(e,r,n,c),B:this.createBContour(e,r,n,c),C:this.createCContour(e,r,n,c),D:this.createDContour(e,r,n,c),E:this.createEContour(e,r,n,c),F:this.createFContour(e,r,n,c),G:this.createGContour(e,r,n,c),H:this.createHContour(e,r,n,c),I:this.createIContour(e,r,n,c),J:this.createJContour(e,r,n,c),K:this.createKContour(e,r,n,c),L:this.createLContour(e,r,n,c),M:this.createMContour(e,r,n,c),N:this.createNContour(e,r,n,c),O:this.createOContour(e,r,n,c),P:this.createPContour(e,r,n,c),Q:this.createQContour(e,r,n,c),R:this.createRContour(e,r,n,c),S:this.createSContour(e,r,n,c),T:this.createTContour(e,r,n,c),U:this.createUContour(e,r,n,c),V:this.createVContour(e,r,n,c),W:this.createWContour(e,r,n,c),X:this.createXContour(e,r,n,c),Y:this.createYContour(e,r,n,c),Z:this.createZContour(e,r,n,c),0:this.createNumber0Contour(e,r,n,c),1:this.createNumber1Contour(e,r,n,c),2:this.createNumber2Contour(e,r,n,c),3:this.createNumber3Contour(e,r,n,c),4:this.createNumber4Contour(e,r,n,c),5:this.createNumber5Contour(e,r,n,c),6:this.createNumber6Contour(e,r,n,c),7:this.createNumber7Contour(e,r,n,c),8:this.createNumber8Contour(e,r,n,c),9:this.createNumber9Contour(e,r,n,c)}[t.toUpperCase()]||this.createDefaultContour(e,r,n,c)}},this.font=this.fonts.Basic}createAContour(t,e,r,o){return[[new THREE.Vector3(t,e,0),new THREE.Vector3(t+r/2,e+o,0),new THREE.Vector3(t+r,e,0),new THREE.Vector3(t+.8*r,e,0),new THREE.Vector3(t+r/2,e+.7*o,0),new THREE.Vector3(t+.2*r,e,0)],[new THREE.Vector3(t+.3*r,e+.4*o,0),new THREE.Vector3(t+.7*r,e+.4*o,0),new THREE.Vector3(t+.7*r,e+.55*o,0),new THREE.Vector3(t+.3*r,e+.55*o,0)]]}createBContour(t,e,r,o){return[[new THREE.Vector3(t,e,0),new THREE.Vector3(t,e+o,0),new THREE.Vector3(t+.7*r,e+o,0),new THREE.Vector3(t+r,e+.8*o,0),new THREE.Vector3(t+r,e+.6*o,0),new THREE.Vector3(t+.7*r,e+.5*o,0),new THREE.Vector3(t+r,e+.4*o,0),new THREE.Vector3(t+r,e+.2*o,0),new THREE.Vector3(t+.7*r,e,0),new THREE.Vector3(t,e,0)]]}createDefaultContour(t,e,r,o){return[[new THREE.Vector3(t,e,0),new THREE.Vector3(t+r,e,0),new THREE.Vector3(t+r,e+o,0),new THREE.Vector3(t,e+o,0)]]}getFont(){return this.font}generateTextContours(t,e,r,o){if(!this.font||!t||!o)return[];const n=this.font.getPath(t,0,0,r),c=[];return Array.isArray(n)&&n.forEach(t=>{t.contours&&t.contours.length>0&&t.contours.forEach(t=>{const r=t.map(t=>{const r=new THREE.Vector3(t.x+e.x,t.y+e.y,0);return o.localToWorld(r)});r.length>0&&r.push(r[0].clone()),c.push(r)})}),c}}