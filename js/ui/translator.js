export class Translator{constructor(){this.currentLang="ru",this.fallbackLang="ru",this.dictionaries={ru:{},en:{"КонтрБагCAD":"KontrBugCAD","Без названия":"Untitled","Готов":"Ready","Файл":"File","Новый проект (Ctrl+N)":"New Project (Ctrl+N)","Открыть проект":"Open Project","Сохранить проект (Ctrl+S)":"Save Project (Ctrl+S)","Импорт/Экспорт":"Import/Export","Импорт STL":"Import STL","Экспорт":"Export","Импорт SVG":"Import SVG","Экспорт скетча в SVG":"Export Sketch to SVG","Редактирование":"Edit","Отменить (Ctrl+Z)":"Undo (Ctrl+Z)","Повторить (Ctrl+Y)":"Redo (Ctrl+Y)","Удалить (Delete)":"Delete","Выделение":"Select","Создать рабочую плоскость":"Create Workplane","Чертеж (Скетч)":"Sketch","Вытягивание":"Extrude","Создать тело вращения":"Revolve","Фаска":"Chamfer","Копирование":"Copy","Копировать (Ctrl+C)":"Copy (Ctrl+C)","Вставить (Ctrl+V)":"Paste (Ctrl+V)","Дублировать (Ctrl+D)":"Duplicate (Ctrl+D)","Трансформация":"Transform","Перемещение (W)":"Move (W)","Вращение (R)":"Rotate (R)","Масштаб (S)":"Scale (S)","Булевы операции":"Boolean Operations","Объединение":"Union","Вычитание":"Subtract","Пересечение":"Intersect","Операции":"Operations","Разрезать по плоскости (Ctrl+Shift+S)":"Split by plane (Ctrl+Shift+S)","Разрезать":"Split","Отражение (Ctrl+Shift+M)":"Mirror (Ctrl+Shift+M)","Группировать (Ctrl+G)":"Group (Ctrl+G)","Разгруппировать (Ctrl+Shift+G)":"Ungroup (Ctrl+Shift+G)","Генераторы":"Generators","Шестерня":"Gear","Генератор шестерней":"Gear Generator","Резьба":"Thread","Генератор резьбы":"Thread Generator","3D Текст":"3D Text","Изображение":"Image","Линейка (Ctrl+M)":"Ruler (Ctrl+M)","Сетка":"Grid","Оси":"Axes","Каркас":"Wireframe","Вид":"View","Вид сверху":"Top View","Вид слева":"Left View","Вид спереди":"Front View","Вид справа":"Right View","Вид снизу":"Bottom View","Домой":"Home","Перспективная проекция":"Perspective Projection","Ортографическая проекция":"Orthographic Projection","Библиотека":"Library","Библиотека моделей":"Model Library","Поиск примитивов...":"Search primitives...","Примитивы":"Primitives","Перетащите элемент в 3D окно для создания":"Drag element to 3D window to create","Свойства":"Properties","Центрирование":"Centering","Центрировать по X":"Center on X","Центрировать по Y":"Center on Y","Центрировать по Z":"Center on Z","Центрировать по всем осям":"Center on all axes","Внешний вид":"Appearance","Цвет":"Color","Прозрачность":"Opacity","Объекты":"Objects","Объекты в сцене":"Objects in scene","Объектов":"Objects","Вершин":"Vertices","Полигонов":"Polygons","История":"History","История действий":"Action History","Очистить":"Clear","Экспорт модели":"Export Model","Название файла":"File name","Формат":"Format","Только выделенные объекты":"Only selected objects","Отмена":"Cancel","Сохранить проект":"Save Project","Название проекта":"Project name","Описание":"Description","Сохраненные проекты":"Saved projects","увеличивает размер файла сохранения":"increases save file size","О программе":"About","Разработчик":"Developer","Технологии":"Technologies","Режим:":"Mode:","Выбрано:":"Selected:","FPS:":"FPS:","Память:":"Memory:","Версия:":"Version:","следить за обновлениями":"follow updates","Настройки":"Settings","Включить автосохранение":"Enable auto-save","Тема":"Theme","Тёмная":"Dark","Светлая":"Light","Авто":"Auto","Окружение":"Environment","Цвет фона:":"Background color:","Цвет сетки:":"Grid color:","Единицы сетки:":"Grid units:","Шаг сетки:":"Grid step:","мм":"mm","дюймы":"inches","Сбросить":"Reset","Управление: ЛКМ - выделение, ПКМ - вращение, Колесико - перемещение":"Controls: LMB - select, RMB - rotate, Wheel - pan","Ctrl+H - привязка к сетке":"Ctrl+H - snap to grid","X:":"X:","Y:":"Y:","Z:":"Z:","Не выбрано объектов для копирования":"No objects selected for copying","Скопировано объектов:":"Copied objects:","Буфер обмена пуст":"Clipboard is empty","Вставлено объектов:":"Pasted objects:","Не выбрано объектов для дублирования":"No objects selected for duplication","Дублировано объектов:":"Duplicated objects:","Нет объектов для выделения":"No objects to select","Выделено объектов:":"Selected objects:","Объект удален":"Object deleted","Объектов:":"Objects:","Вершин:":"Vertices:","Полигонов:":"Polygons:","Сетка: вкл":"Grid: on","Сетка: выкл":"Grid: off","Оси: вкл":"Axes: on","Оси: выкл":"Axes: off","Режим каркаса переключен":"Wireframe mode toggled","Автосохранение включено":"Auto-save enabled","Автосохранение выключено":"Auto-save disabled","Настройки окружения сброшены":"Environment settings reset","Материал объекта не поддерживает изменение цвета":"Object material does not support color change","Отменено":"Undone","Повторено":"Redone","Единицы сетки: мм":"Grid units: mm","Единицы сетки: дюймы":"Grid units: inches","Шаг сетки:":"Grid step:","дюйма":"inch","дюйм":"inch","За актуальной информацией следите в Telegramm канале":"For updates follow Telegram channel","Tg:":"Tg:","ВК:":"VK:","Оф. сайт:":"Official site:","Обратите внимание! Редактор находится на стадии активной разработки, и не все функции работают в полной мере. Но ваше тестирование поможет улучшить его работу. Буду благодарен за обратную связь, сообщения об ошибках и предложения по развитию.":"Note! The editor is under active development, and not all features work fully. But your testing will help improve it. I would be grateful for feedback, bug reports and development suggestions.","Автор:":"Author:","Готово":"Ready","Загрузка...":"Loading...","Ошибка":"Error","Объект":"Object","Рабочая плоскость":"Workplane","Плоскость скетча":"Sketch plane","Элемент скетча":"Sketch element","Группа":"Group","Наружная резьба":"External thread","Внутренняя резьба":"Internal thread","Базовые":"Basic","Формы":"Shapes","Механика":"Mechanical","Электронные компоненты":"Electronic components","КонтрБагТех":"KontrBugTech","Крепеж":"Fasteners","Создание примитива":"Create primitive","Импорт STL":"Import STL","Перемещение":"Move","Выдавливание":"Extrude","Группировка":"Group","Разгруппировка":"Ungroup","Создание рабочей плоскости":"Create workplane","Скетч":"Sketch","Импорт объекта":"Import object","Удаление объектов":"Delete objects","ВЫТЯГИВАНИЕ":"EXTRUDE","Высота (мм):":"Height (mm)","Направление:":"Direction","Операция:":"Operation","Кликните по региону для выбора":"Click on the region to select","Описание:":"Description","Этот инструмент создает объемное тело путем линейного вытягивания плоского эскиза в перпендикулярном ему направлении.• Клик по фигуре: выделить/снять выделение• Перетаскивайте стрелку для изменения высоты• Escape для отмены, Enter для подтверждения":"This tool creates a three-dimensional body by linearly stretching a flat sketch in a perpendicular direction.• Click on the shape: select/deselect• Drag the arrow to change the height• Escape to cancel, Enter to confirm"}},this.loadingPromises={},this.loadLanguagePreference(),"ru"!==this.currentLang?this.loadDictionary(this.currentLang).then(()=>{this.applyTranslations(),this.observeMutations(),window.dispatchEvent(new CustomEvent("languageLoaded"))}):(this.applyTranslations(),this.observeMutations(),window.dispatchEvent(new CustomEvent("languageLoaded"))),window.addEventListener("languageChanged",()=>{this.applyTranslations()})}loadLanguagePreference(){const e=localStorage.getItem("cad_language");if(e&&"ru"!==e)this.currentLang=e;else{const e=navigator.language.substring(0,2);this.currentLang="ru"!==e?e:"ru"}}async loadDictionary(e){if(this.dictionaries[e])return this.dictionaries[e];if(this.loadingPromises[e])return this.loadingPromises[e];const t=`js/ui/languages/${e}.json`,r=fetch(t).then(e=>{if(!e.ok)throw new Error(`Failed to load ${t}`);return e.json()}).then(t=>(this.dictionaries[e]=t,delete this.loadingPromises[e],t)).catch(t=>(console.warn(`Could not load language ${e}, using fallback (${this.fallbackLang})`,t),delete this.loadingPromises[e],this.dictionaries[e]={},{}));return this.loadingPromises[e]=r,r}getNavigationCubeLetters(){return"en"==this.currentLang?["Right","Left","Up","Down","Back","Front"]:["Право","Лево","Верх","Низ","Зад","Перед"]}async setLanguage(e){e!==this.currentLang&&("ru"===e||this.dictionaries[e]||await this.loadDictionary(e),this.currentLang=e,localStorage.setItem("cad_language",e),window.dispatchEvent(new CustomEvent("languageChanged",{detail:{language:e}})))}translate(e){if(!e)return e;if("ru"===this.currentLang)return e;const t=this.dictionaries[this.currentLang];return t&&void 0!==t[e]?t[e]:e}applyTranslations(e=document.body){this.translateNode(e),e.querySelectorAll("[title]").forEach(e=>{const t=e.getAttribute("data-original-title")||e.title;e.setAttribute("data-original-title",t),e.title=this.translate(t)}),e.querySelectorAll("[placeholder]").forEach(e=>{const t=e.getAttribute("data-original-placeholder")||e.placeholder;e.setAttribute("data-original-placeholder",t),e.placeholder=this.translate(t)}),e.querySelectorAll("option").forEach(e=>{const t=e.getAttribute("data-original-text")||e.textContent;e.setAttribute("data-original-text",t),e.textContent=this.translate(t)})}translateNode(e){if(e.nodeType===Node.TEXT_NODE){const t=e.textContent.trim();if(t){let r=e.parentNode?.getAttribute("data-original-text");r||(r=t,e.parentNode?.setAttribute("data-original-text",r));const o=this.translate(r);o!==e.textContent&&(e.textContent=o)}}else if(e.nodeType===Node.ELEMENT_NODE&&"INPUT"!==e.tagName&&"TEXTAREA"!==e.tagName&&"SCRIPT"!==e.tagName&&"STYLE"!==e.tagName)for(const t of e.childNodes)this.translateNode(t)}observeMutations(){new MutationObserver(e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)e.nodeType===Node.ELEMENT_NODE&&this.applyTranslations(e)}).observe(document.body,{childList:!0,subtree:!0})}translateDynamic(e){return this.translate(e)}getLanguageName(e){return{ru:"Русский",en:"English",es:"Español"}[e]||e}}