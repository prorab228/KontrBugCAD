class FigureNode{constructor(e){this.id=`figure_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,this.contour=e,this.parent=null,this.children=[],this.depth=0,this.isHole=!1,this.isOuter=!0,this.area=e.area||0,this.boundingBox=e.boundingBox,this.center=e.center,this.elementIds=new Set,this.element=e.element||(e.elements?e.elements[0]:null),e.element?this.elementIds.add(e.element.uuid):e.elements&&e.elements.forEach(e=>this.elementIds.add(e.uuid)),this.type=e.type||"unknown",this.isClosed=e.isClosed||!1,this.isClockwise=e.isClockwise||!1}addChild(e){return!this.children.includes(e)&&(this.children.push(e),e.parent=this,e.depth=this.depth+1,!0)}removeChild(e){const t=this.children.indexOf(e);return t>-1&&(this.children.splice(t,1),e.parent=null,e.depth=0,!0)}getAllDescendants(){const e=[],t=s=>{s.children.forEach(s=>{e.push(s),t(s)})};return t(this),e}getHoleDescendants(){return this.getAllDescendants().filter(e=>e.isHole)}getOuterDescendants(){return this.getAllDescendants().filter(e=>!e.isHole)}getImmediateHoles(){return this.children.filter(e=>this.isHole&&!e.isHole||!this.isHole&&e.isHole)}getImmediateOuters(){return this.children.filter(e=>!e.isHole)}isAncestorOf(e){let t=e;for(;t;){if(t===this)return!0;t=t.parent}return!1}isDescendantOf(e){return e.isAncestorOf(this)}getChildrenIds(){return this.children.map(e=>e.id)}getPathToRoot(){const e=[];let t=this;for(;t;)e.unshift(t),t=t.parent;return e}getNestingLevel(){return this.depth}toString(){return`${this.isHole?"HOLE":"OUTER"}[depth=${this.depth}, area=${this.area.toFixed(2)}, children=${this.children.length}]`}}