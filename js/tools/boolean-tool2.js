class BooleanTool extends Tool{constructor(e,t){super(`boolean-${t}`,BooleanTool.getIcon(t),e),this.operation=t,this.requiresSelection=!0,this.minObjects=2}static getIcon(e){return{union:"fa-plus-circle",subtract:"fa-minus-circle",intersect:"fa-times-circle"}[e]||"fa-object-group"}getOperationName(){return{union:"объединения",subtract:"вычитания",intersect:"пересечения"}[this.operation]||this.operation}async onActivate(){if(this.canActivate()){if(this.editor.selectedObjects.length<this.minObjects)return this.editor.showStatus(`Для ${this.getOperationName()} необходимо выбрать минимум ${this.minObjects} объекта`,"error"),void this.editor.toolManager.restorePreviousTool();await this.performBooleanOperation(),setTimeout(()=>{this.editor.toolManager.restorePreviousTool()},100)}else this.editor.toolManager.restorePreviousTool()}async performBooleanOperation(){if(!this.editor.booleanOps)return void this.editor.showStatus("Булевы операции не инициализированы","error");const e=this.editor.booleanOps.canPerformOperation("subtract"===this.operation||"intersect"===this.operation?this.editor.selectedObjects.slice(0,2):this.editor.selectedObjects);if(e.can){this.showLoadingIndicator(`Выполняется ${this.getOperationName()}...`);try{const e=`boolean_${this.operation}`,t=this.editor.selectedObjects.map(e=>e.uuid),o=new ParametricOperation(e,{},t);this.editor.parametricModel.addOperation(o),this.hideLoadingIndicator(),this.editor.showStatus(`Операция "${this.getOperationName()}" завершена`,"success")}catch(e){this.hideLoadingIndicator(),console.error(`${this.operation} error:`,e),this.editor.showStatus(`Ошибка ${this.getOperationName()}: ${e.message}`,"error")}}else this.editor.showStatus(e.reason,"error")}showLoadingIndicator(e){let t=document.getElementById("boolLoadingIndicator");if(t)t.querySelector(".message").textContent=e,t.style.display="flex";else if(t=document.createElement("div"),t.id="boolLoadingIndicator",t.style.cssText="\n                position: fixed;\n                top: 50%;\n                left: 50%;\n                transform: translate(-50%, -50%);\n                background: rgba(0, 0, 0, 0.8);\n                color: white;\n                padding: 20px 30px;\n                border-radius: 8px;\n                z-index: 10001;\n                display: flex;\n                align-items: center;\n                gap: 15px;\n                font-family: Arial, sans-serif;\n            ",t.innerHTML=`\n                <div class="spinner" style="\n                    width: 24px;\n                    height: 24px;\n                    border: 3px solid rgba(255, 255, 255, 0.3);\n                    border-radius: 50%;\n                    border-top-color: #fff;\n                    animation: spin 1s linear infinite;\n                "></div>\n                <div class="message">${e}</div>\n            `,document.body.appendChild(t),!document.querySelector("#boolLoadingStyles")){const e=document.createElement("style");e.id="boolLoadingStyles",e.textContent="@keyframes spin { to { transform: rotate(360deg); } }",document.head.appendChild(e)}}hideLoadingIndicator(){const e=document.getElementById("boolLoadingIndicator");e&&(e.style.display="none")}}class BooleanUnionTool extends BooleanTool{constructor(e){super(e,"union")}}class BooleanSubtractTool extends BooleanTool{constructor(e){super(e,"subtract")}}class BooleanIntersectTool extends BooleanTool{constructor(e){super(e,"intersect")}}