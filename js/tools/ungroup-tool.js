class UngroupTool extends Tool{constructor(t){super("ungroup","fa-object-ungroup",t),this.requiresSelection=!0}onActivate(){if(!this.canActivate())return void this.editor.toolManager.restorePreviousTool();const t=this.editor.selectedObjects.filter(t=>"group"===t.userData?.type);if(0===t.length)return this.editor.showStatus("Для разгруппировки выберите группу","error"),void this.editor.toolManager.restorePreviousTool();this.performUngrouping(t),setTimeout(()=>{this.editor.toolManager.restorePreviousTool()},100)}performUngrouping(t){const o=[];t.forEach(t=>{const e=[];t.children.forEach(o=>{if(o!==t){const t=new THREE.Vector3;o.getWorldPosition(t),e.push({uuid:o.uuid,worldPosition:t.toArray()})}});const r=new ParametricOperation("ungroup",{groupId:t.uuid,childrenData:e},[]);this.editor.parametricModel.addOperation(r),o.push(...e.map(t=>t.uuid))}),setTimeout(()=>{const t=[];o.forEach(o=>{const e=this.editor.parametricModel.objectMap.get(o);e&&t.push(e)}),this.editor.clearSelection(),t.forEach(t=>{this.editor.selectedObjects.push(t),this.editor.objectsManager.highlightObject(t)})},0),this.editor.showStatus(`Разгруппировано ${t.length} групп`,"success")}onDeactivate(){}}