class BooleanTool extends Tool{constructor(t,e){super(`boolean-${e}`,BooleanTool.getIcon(e),t),this.operation=e,this.requiresSelection=!0,this.minObjects=2}static getIcon(t){return{union:"fa-plus-circle",subtract:"fa-minus-circle",intersect:"fa-times-circle"}[t]||"fa-object-group"}getOperationName(){return{union:"объединения",subtract:"вычитания",intersect:"пересечения"}[this.operation]||this.operation}onActivate(){if(this.canActivate()){if(this.editor.selectedObjects.length<this.minObjects)return this.editor.showStatus(`Для ${this.getOperationName()} необходимо выбрать минимум ${this.minObjects} объекта`,"error"),void this.editor.toolManager.restorePreviousTool();this.performBooleanOperation(),setTimeout(()=>{this.editor.toolManager.restorePreviousTool()},100)}else this.editor.toolManager.restorePreviousTool()}performBooleanOperation(){if(!this.editor.booleanOps)return void this.editor.showStatus("Булевы операции не инициализированы","error");const t=this.editor.booleanOps.canPerformOperation("subtract"===this.operation||"intersect"===this.operation?this.editor.selectedObjects.slice(0,2):this.editor.selectedObjects);t.can?t.warning&&!confirm(`${t.reason}\nПродолжить операцию?`)||(this.editor.showLoadingIndicator(`Выполняется ${this.getOperationName()}...`),setTimeout(()=>{try{let t;switch(this.operation){case"union":t=this.editor.performUnion();break;case"subtract":t=this.editor.performSubtract();break;case"intersect":t=this.editor.performIntersect()}this.editor.hideLoadingIndicator(),t?this.editor.addBooleanResult(t,this.operation):this.editor.showStatus("Операция не дала результата","error")}catch(t){this.editor.hideLoadingIndicator(),console.error(`${this.operation} error:`,t),this.editor.showStatus(`Ошибка ${this.getOperationName()}: ${t.message}`,"error")}},50)):this.editor.showStatus(t.reason,"error")}}class BooleanUnionTool extends BooleanTool{constructor(t){super(t,"union")}}class BooleanSubtractTool extends BooleanTool{constructor(t){super(t,"subtract")}}class BooleanIntersectTool extends BooleanTool{constructor(t){super(t,"intersect")}}