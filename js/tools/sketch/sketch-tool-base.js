class SketchToolBase{constructor(e,t,s){this.sketchManager=e,this.name=t,this.icon=s,this.isDrawing=!1,this.tempElement=null,this.tempGeometry=null,this.drawingStage=0,this.dimensionFields=[],this.snapHelper=e.snapHelper}onMouseDown(e){return!!this.sketchManager.isInputActive&&(this.sketchManager.applyDimensionInput(),!0)}onMouseMove(e){if(this.snapHelper){const t=this.getPointOnPlane(e,!1);this.snapHelper.handleMouseMove(e,t)}}onMouseUp(e){}onKeyDown(e){return!1}onCancel(){this.isDrawing=!1,this.drawingStage=0,this.clearTempGeometry(),this.tempElement=null,this.sketchManager.clearDimensionObjects()}getPointOnPlane(e,t=!0){const s=this.sketchManager.getPointOnPlane(e);if(!(s&&t&&this.snapHelper&&this.snapHelper.snapEnabled))return s;const i=this.snapHelper.getSnappedPoint(s);return this.snapHelper.currentSnapPoint&&i!==s?i:s}getDimensionConfig(){return{fields:this.dimensionFields,callback:e=>this.applyDimensions(e)}}applyDimensions(e){this.tempElement&&this.sketchManager.addElement(this.tempElement),this.clearToolState()}clearToolState(){this.isDrawing=!1,this.drawingStage=0,this.clearTempGeometry(),this.tempElement=null,this.sketchManager.clearDimensionObjects(),this.sketchManager.hideDimensionInput()}showDimensionInput(e,t){const s=this.getDimensionConfig();t&&this.tempElement&&s.fields.forEach((e,i)=>{void 0!==t[i]&&(s.fields[i].value=t[i])}),this.sketchManager.showDimensionInput(e,s)}getPreviewMaterial(){return new THREE.LineBasicMaterial({color:new THREE.Color(this.sketchManager.previewColor),linewidth:this.sketchManager.previewLineWidth,transparent:!0,opacity:this.sketchManager.previewOpacity,polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1})}createTempGeometry(){if(this.clearTempGeometry(),!this.tempElement)return;const e={...this.tempElement};e.color=this.sketchManager.previewColor;const t=this.createGeometry(e);t&&(this.tempGeometry=t,this.sketchManager.currentPlane.add(t))}updateTempGeometry(){this.tempGeometry&&this.tempElement&&this.updateGeometry(this.tempGeometry,this.tempElement)}clearTempGeometry(){this.tempGeometry&&(this.tempGeometry.parent&&this.tempGeometry.parent.remove(this.tempGeometry),this.tempGeometry.geometry&&this.tempGeometry.geometry.dispose(),this.tempGeometry.material&&this.tempGeometry.material.dispose(),this.tempGeometry=null)}createGeometry(e){return null}updateGeometry(e,t){}createDimensionHelpers(e){}}