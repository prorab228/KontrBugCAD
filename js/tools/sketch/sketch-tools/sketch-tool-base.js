class SketchToolBase{constructor(e,t,i){this.sketchManager=e,this.name=t,this.icon=i,this.isDrawing=!1,this.tempElement=null,this.tempGeometry=null,this.drawingStage=0,this.dimensionFields=[],this.snapHelper=e.snapHelper}onMouseDown(e){return!!this.sketchManager.dimensionManager.isInputActive&&(this.sketchManager.dimensionManager.applyDimensionInput(),!0)}onMouseMove(e){}onMouseUp(e){}onKeyDown(e){return!1}onCancel(){this.isDrawing=!1,this.drawingStage=0,this.clearTempGeometry(),this.tempElement=null,this.sketchManager.dimensionManager.clearDimensionObjects()}getPointOnPlane(e,t=!0){const i=this.sketchManager.getPointOnPlane(e);return i&&t&&this.snapHelper?this.snapHelper.getSnappedPoint(i,this):i}getDimensionConfig(){return{fields:this.dimensionFields,callback:e=>this.applyDimensions(e)}}applyDimensions(e){this.tempElement&&this.sketchManager.elementManager.addElement(this.tempElement),this.clearToolState()}clearToolState(){this.isDrawing=!1,this.drawingStage=0,this.clearTempGeometry(),this.tempElement=null,this.sketchManager.dimensionManager.clearDimensionObjects(),this.sketchManager.dimensionManager.hideDimensionInput()}showDimensionInput(e,t){const i=this.getDimensionConfig();t&&this.tempElement&&i.fields.forEach((e,n)=>{void 0!==t[n]&&(i.fields[n].value=t[n])}),this.sketchManager.dimensionManager.showDimensionInput(e,i)}getPreviewMaterial(){return new THREE.LineBasicMaterial({color:new THREE.Color(this.sketchManager.previewColor),linewidth:this.sketchManager.previewLineWidth,transparent:!0,opacity:this.sketchManager.previewOpacity,polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1})}createTempGeometry(){if(this.clearTempGeometry(),!this.tempElement)return;const e={...this.tempElement};e.color=this.sketchManager.previewColor;const t=this.createGeometry(e);t&&(this.tempGeometry=t,this.sketchManager.currentPlane.add(t))}updateTempGeometry(){this.tempGeometry&&this.tempElement&&this.updateGeometry(this.tempGeometry,this.tempElement)}clearTempGeometry(){this.tempGeometry&&(this.tempGeometry.parent&&this.tempGeometry.parent.remove(this.tempGeometry),this.tempGeometry.geometry&&this.tempGeometry.geometry.dispose(),this.tempGeometry.material&&this.tempGeometry.material.dispose(),this.tempGeometry=null)}createGeometry(e){return null}updateGeometry(e,t){}createDimensionHelpers(e){}}