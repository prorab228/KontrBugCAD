class SketchViewManager{constructor(e){this.sketchManager=e,this.grid=null,this.backgroundPlane=null,this.gridVisible=!0,this.gridStep=1,this.gridSize=150}recreateGrid(){this.removeSketchGrid(),this.gridVisible&&(this.createBackgroundPlane(),this.createSketchGrid())}createBackgroundPlane(){if(!this.sketchManager.currentPlane)return;const e=new THREE.PlaneGeometry(2*this.gridSize,2*this.gridSize),i=new THREE.MeshBasicMaterial({color:16777215,transparent:!0,opacity:.4,side:THREE.DoubleSide,depthWrite:!1}),t=new THREE.Mesh(e,i);t.position.set(0,0,0),t.userData.isGridBackground=!0,t.raycast=()=>{},this.sketchManager.currentPlane.add(t),this.backgroundPlane=t}createSketchGrid(){if(!this.sketchManager.currentPlane||!this.gridVisible)return;let e=this.sketchManager.gridStep;"inch"===this.sketchManager.editor.gridUnit&&(e*=25.4);const i=this.gridSize,t=e,r=i/t,a=2236962,s=5592405;this.grid=[];for(let e=1;e<=r;e++){const r=e*t;this.createGridLine(-i,r,i,r,0===e?s:a)}for(let e=0;e>=-r;e--){const r=e*t;this.createGridLine(-i,r,i,r,0===e?s:a)}for(let e=1;e<=r;e++){const r=e*t;this.createGridLine(r,-i,r,i,0===e?s:a)}for(let e=0;e>=-r;e--){const r=e*t;this.createGridLine(r,-i,r,i,0===e?s:a)}}createGridLine(e,i,t,r,a){const s=new THREE.Vector3(e,i,.05),n=new THREE.Vector3(t,r,.05),h=(new THREE.BufferGeometry).setFromPoints([s,n]),d=new THREE.LineBasicMaterial({color:a,linewidth:1,transparent:!0,opacity:.1}),c=new THREE.Line(h,d);c.userData.isGrid=!0,this.sketchManager.currentPlane.add(c),this.grid.push(c)}removeSketchGrid(){this.backgroundPlane&&(this.backgroundPlane.parent&&this.backgroundPlane.parent.remove(this.backgroundPlane),this.backgroundPlane.geometry&&this.backgroundPlane.geometry.dispose(),this.backgroundPlane.material&&this.backgroundPlane.material.dispose(),this.backgroundPlane=null),this.grid&&(this.grid.forEach(e=>{e.parent&&e.parent.remove(e),e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()}),this.grid=null)}updateGrid(){this.gridVisible?this.recreateGrid():this.removeSketchGrid()}setGridVisible(e){this.gridVisible=e,this.updateGrid()}clear(){this.removeSketchGrid(),this.grid=null,this.backgroundPlane=null,this.gridVisible=!0}}